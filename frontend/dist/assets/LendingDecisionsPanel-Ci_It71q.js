import{e as ze,r as Te,j as e,B as t,R as Ee}from"./index-CLIkutcF.js";import{C as Je,a as We,b as Ye,c as Ge,d as Ve}from"./Combination-VzPjPnOx.js";import{D as Ke,a as Qe,F as Se,b as Xe,c as d,f as w}from"./AdminDashboard-D0Usvj4c.js";import{T as Be,k as Fe,l as c,n,o as He,p as a}from"./BatchUploadResults-DDs0gbJS.js";import{D as Ze,R as Ue}from"./tooltip-BzEeHMsZ.js";import{f as Oe}from"./checkbox-B8vwzNvb.js";import{a as es}from"./separator-BLcX6XFs.js";import"./EnhancedRegister-CfCga3ys.js";import"./shield-klLB-pUT.js";import"./api-dGCjnlFh.js";import"./textarea-BeCFIVKL.js";import"./lock-BKxMHSyS.js";/**
 * @license lucide-react v0.518.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],u=ze("chevron-up",ss),as={home_purchase:"Home Purchase Loan",refinance:"Refinance Loan",home_equity:"Home Equity Loan (HEL)",heloc:"Home Equity Line of Credit (HELOC)",construction:"Construction Loan",new_car:"New Car Loan",used_car:"Used Car Loan",auto_refinance:"Auto Refinance",lease_buyout:"Lease Buyout Loan",federal_student:"Federal Student Loan",private_student:"Private Student Loan",student_refinance:"Student Loan Refinance",credit_card:"Credit Card",store_card:"Store/Retail Card",charge_card:"Charge Card",secured_card:"Secured Credit Card",personal_unsecured:"Unsecured Personal Loan",personal_secured:"Secured Personal Loan",debt_consolidation:"Debt Consolidation",medical_loan:"Medical Loan",wedding_loan:"Wedding or Vacation Loan",emergency_loan:"Emergency Loan",business_term:"Term Business Loan",business_line:"Line of Credit",sba_loan:"SBA or Government-backed Loan",equipment_finance:"Equipment Financing",invoice_finance:"Invoice Financing",microfinance:"Microfinance Loan",bnpl:"Buy Now, Pay Later (BNPL)",installment_retail:"Installment Purchase Loan",mobile_loan:"Mobile Loan",crop_loan:"Crop Loan",livestock_loan:"Livestock Loan",agri_equipment:"Agricultural Equipment Loan",seasonal_loan:"Seasonal Working Capital"},ps=({lendingLoading:N,groupedLendingDecisions:x=[],error:g,onRefresh:Pe,onUserSelect:l,selectedUserDecisions:o})=>{const[m,b]=Te.useState(null),[v,h]=Te.useState(null),qe=i=>{if(m===i)b(null),h(null),l&&l(null);else{b(i),h(null);const r=x.find(y=>y.user===i);l&&l(r?r.all:null)}},Ie=i=>{h(v===i?null:i)};return e.jsxs(Je,{className:"border border-[#1a4a38] overflow-hidden",children:[e.jsx(We,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(Ye,{className:"text-gray-900 dark:text-white",children:"Lending Decision Logs"}),e.jsx(Ge,{className:"text-gray-600 dark:text-[#a8d5ba]",children:"Review approval/rejection decisions and overrides"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(t,{className:"bg-[#9c27b0] hover:bg-[#7b1fa2] text-white flex-1 sm:flex-none",children:[e.jsx(Ze,{className:"mr-2 h-4 w-4"}),e.jsx("span",{className:"whitespace-nowrap",children:"Export Logs"})]}),e.jsxs(Ke,{children:[e.jsx(Qe,{asChild:!0,children:e.jsxs(t,{variant:"outline",className:"border-[#9c27b0] text-[#9c27b0] flex-1 sm:flex-none",children:[e.jsx(Se,{className:"mr-2 h-4 w-4"}),"Filter"]})}),e.jsxs(Xe,{children:[e.jsx(d,{children:"Approved"}),e.jsx(d,{children:"Rejected"}),e.jsx(d,{children:"Manual Overrides"}),e.jsx(d,{children:"Recent Decisions"})]})]}),e.jsxs(t,{variant:"outline",onClick:Pe,className:"border-[#9c27b0] text-[#9c27b0] hover:bg-[#f0f7f4] dark:hover:bg-[#1a4a38] flex-1 sm:flex-none",disabled:N,children:[e.jsx(Ue,{className:"mr-2 h-4 w-4"}),"Refresh"]})]})]})}),e.jsx(Ve,{className:"p-0 sm:p-6",children:N?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[200px]",children:[e.jsx("div",{className:"animate-spin h-12 w-12 border-t-4 border-b-4 border-[#9c27b0] rounded-full mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading lending decisions..."})]}):g?e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg mb-4 mx-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-red-600 font-bold",children:"Error:"}),e.jsx("span",{className:"text-red-700 dark:text-red-300",children:g})]})}):e.jsx("div",{className:"rounded-lg border border-gray-200 dark:border-gray-800 overflow-hidden",children:e.jsxs(Be,{className:"min-w-full",children:[e.jsx(Fe,{className:"bg-[#f0f7f4] dark:bg-[#1a4a38]",children:e.jsxs(c,{children:[e.jsx(n,{className:"font-semibold w-[18%]",children:"Applicant"}),e.jsx(n,{className:"font-semibold w-[12%]",children:"Decision"}),e.jsx(n,{className:"font-semibold w-[8%]",children:"Score"}),e.jsx(n,{className:"font-semibold w-[20%]",children:"Reason"}),e.jsx(n,{className:"font-semibold w-[12%]",children:"Officer"}),e.jsx(n,{className:"font-semibold w-[10%]",children:"Bank"}),e.jsx(n,{className:"font-semibold w-[12%]",children:"Date"}),e.jsx(n,{className:"font-semibold w-[8%] text-right",children:"Actions"})]})}),e.jsx(He,{children:x.length===0?e.jsx(c,{children:e.jsx(a,{colSpan:8,className:"text-center py-8",children:e.jsxs("div",{className:"flex flex-col items-center text-gray-500",children:[e.jsx(Se,{className:"h-8 w-8 mb-2"}),"No lending decisions found"]})})}):x.map(({user:i,latest:r,all:y})=>{var L,D,C;return e.jsxs(Ee.Fragment,{children:[e.jsxs(c,{className:"hover:bg-[#f0f7f4] dark:hover:bg-[#1a4a38] cursor-pointer",onClick:()=>qe(i),children:[e.jsx(a,{className:"font-medium truncate max-w-[160px]",children:e.jsxs("div",{className:"flex items-center",children:[m===i?e.jsx(u,{className:"h-4 w-4 mr-2 text-[#9c27b0]"}):e.jsx(Oe,{className:"h-4 w-4 mr-2 text-[#9c27b0]"}),e.jsx("span",{className:"truncate",children:((L=r.applicant)==null?void 0:L.name)||r.applicant||"N/A"})]})}),e.jsx(a,{children:e.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${r.decision==="Approved"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:r.decision})}),e.jsx(a,{children:r.score}),e.jsx(a,{className:"truncate max-w-[220px]",children:r.reason}),e.jsx(a,{className:"truncate max-w-[140px]",children:((D=r.officer)==null?void 0:D.name)||r.officer||"N/A"}),e.jsx(a,{className:"truncate max-w-[120px]",children:r.bank||"N/A"}),e.jsx(a,{children:r.date?w(new Date(r.date),"MMM d, yyyy"):"N/A"}),e.jsx(a,{className:"text-right",children:e.jsx(t,{variant:"ghost",size:"sm",children:e.jsx(es,{className:"h-4 w-4"})})})]}),m===i&&o&&e.jsx(c,{children:e.jsx(a,{colSpan:8,className:"bg-[#f9fbe7] dark:bg-[#23291a] p-0",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("h4",{className:"font-semibold mb-3 text-[#9c27b0] flex items-center",children:[e.jsx(u,{className:"h-5 w-5 mr-2"}),"All Lending Decisions for ",((C=r.applicant)==null?void 0:C.name)||r.applicant||"this user"]}),e.jsx("div",{className:"border rounded-lg overflow-x-auto",children:e.jsxs(Be,{className:"min-w-full",children:[e.jsx(Fe,{className:"bg-[#f0f7f4] dark:bg-[#1a4a38]",children:e.jsxs(c,{children:[e.jsx(n,{className:"min-w-[100px]",children:"Decision"}),e.jsx(n,{className:"min-w-[120px]",children:"System Decision"}),e.jsx(n,{className:"min-w-[80px]",children:"Score"}),e.jsx(n,{className:"min-w-[100px]",children:"Amount"}),e.jsx(n,{className:"min-w-[110px]",children:"Interest"}),e.jsx(n,{className:"min-w-[80px]",children:"Term"}),e.jsx(n,{className:"min-w-[120px]",children:"Date"}),e.jsx(n,{className:"min-w-[120px]",children:"Officer"}),e.jsx(n,{className:"min-w-[60px] text-center",children:"Details"})]})}),e.jsx(He,{children:o.map((s,j)=>{var _,k,R,M,T,E,S,B,F,H,O,P,q,I,$,z,J,W,Y,G,V,K,Q,X,Z,U,ee,se,ae,ne,re,ie,ce,le,oe,te,de,xe,me,he,je,pe,fe,we,ue,Ne,ge,be,ve,ye,Le,De,Ce,Ae,_e,ke,Re,Me;const p=((R=(k=(_=s.raw)==null?void 0:_.raw)==null?void 0:k.loanDetails)==null?void 0:R.amount)??((T=(M=s.raw)==null?void 0:M.raw)==null?void 0:T.maxLoanAmount)??"N/A",f=((B=(S=(E=s.raw)==null?void 0:E.raw)==null?void 0:S.loanDetails)==null?void 0:B.interestRate)??((H=(F=s.raw)==null?void 0:F.raw)==null?void 0:H.suggestedInterestRate)??"N/A",$e=((q=(P=(O=s.raw)==null?void 0:O.raw)==null?void 0:P.loanDetails)==null?void 0:q.term)??"N/A",A=v===(s.id||j);return e.jsxs(Ee.Fragment,{children:[e.jsxs(c,{className:"cursor-pointer",onClick:()=>Ie(s.id||j),children:[e.jsx(a,{children:e.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${s.decision==="Approved"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.decision})}),e.jsx(a,{children:(($=(I=s.raw)==null?void 0:I.raw)==null?void 0:$.systemDecision)||((J=(z=s.raw)==null?void 0:z.raw)==null?void 0:J.autoDecision)||"—"}),e.jsx(a,{children:s.score}),e.jsx(a,{children:typeof p=="number"?`$${p.toLocaleString()}`:p}),e.jsx(a,{children:typeof f=="number"?`${f}%`:f}),e.jsx(a,{children:$e}),e.jsx(a,{children:s.date?w(new Date(s.date),"MMM d, yyyy"):"N/A"}),e.jsx(a,{children:((W=s.officer)==null?void 0:W.name)||s.officer||"N/A"}),e.jsx(a,{className:"text-center",children:A?e.jsx(u,{className:"h-4 w-4 text-[#9c27b0] mx-auto"}):e.jsx(Oe,{className:"h-4 w-4 text-[#9c27b0] mx-auto"})})]}),A&&e.jsx(c,{children:e.jsx(a,{colSpan:9,className:"bg-[#f3e8fd] dark:bg-[#2d1a38] p-0",children:e.jsxs("div",{className:"p-4",children:[e.jsx("h5",{className:"font-semibold mb-2 text-[#9c27b0]",children:"Decision Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Decision:"})," ",s.decision]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Score:"})," ",s.score]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Reason:"})," ",s.reason||((V=(G=(Y=s.raw)==null?void 0:Y.raw)==null?void 0:G.reasons)==null?void 0:V.join(", "))||"—"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Date:"})," ",s.date?w(new Date(s.date),"MMM d, yyyy, HH:mm"):"N/A"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Bank:"})," ",s.bank||((K=s.raw)==null?void 0:K.bank)||"N/A"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Officer:"})," ",((Q=s.officer)==null?void 0:Q.name)||((X=s.officer)==null?void 0:X.email)||s.officer||"N/A"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Applicant:"})," ",((U=(Z=s.raw)==null?void 0:Z.applicant)==null?void 0:U.name)||((ee=s.applicant)==null?void 0:ee.name)||s.applicant||"N/A"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Loan Amount:"})," ",((ne=(ae=(se=s.raw)==null?void 0:se.raw)==null?void 0:ae.loanDetails)==null?void 0:ne.amount)??((ie=(re=s.raw)==null?void 0:re.raw)==null?void 0:ie.maxLoanAmount)??"N/A"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Term:"})," ",((oe=(le=(ce=s.raw)==null?void 0:ce.raw)==null?void 0:le.loanDetails)==null?void 0:oe.term)??"N/A"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Interest Rate:"})," ",((xe=(de=(te=s.raw)==null?void 0:te.raw)==null?void 0:de.loanDetails)==null?void 0:xe.interestRate)??((he=(me=s.raw)==null?void 0:me.raw)==null?void 0:he.suggestedInterestRate)??"N/A"]}),((pe=(je=s.raw)==null?void 0:je.raw)==null?void 0:pe.loanType)&&e.jsxs("div",{children:[e.jsx("strong",{children:"Loan Type:"})," ",as[s.raw.raw.loanType]||s.raw.raw.loanType]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Manual Decision:"})," ",(we=(fe=s.raw)==null?void 0:fe.raw)!=null&&we.isManual?"Yes":"No"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Recommendations:"})," ",Array.isArray((Ne=(ue=s.raw)==null?void 0:ue.raw)==null?void 0:Ne.recommendations)&&s.raw.raw.recommendations.length>0?s.raw.raw.recommendations.join(", "):"—"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Officer Notes:"})," ",((be=(ge=s.raw)==null?void 0:ge.raw)==null?void 0:be.manualNotes)||"—"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Rejection Reason:"})," ",((ye=(ve=s.raw)==null?void 0:ve.raw)==null?void 0:ye.rejectionReason)||"—"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Flagged for Review:"})," ",(De=(Le=s.raw)==null?void 0:Le.raw)!=null&&De.flagForReview?"Yes":"No"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Review Note:"})," ",((Ae=(Ce=s.raw)==null?void 0:Ce.raw)==null?void 0:Ae.reviewNote)||"—"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Risk Tier Override:"})," ",((ke=(_e=s.raw)==null?void 0:_e.raw)==null?void 0:ke.riskTierOverride)||"—"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Override Justification:"})," ",((Me=(Re=s.raw)==null?void 0:Re.raw)==null?void 0:Me.overrideJustification)||"—"]})]})]})})})]},s.id||j)})})]})}),e.jsxs("div",{className:"mt-3 text-sm text-gray-500 dark:text-gray-400",children:["Showing ",o.length," decision",o.length!==1?"s":""]})]})})})]},i)})})]})})})]})};export{ps as default};
//# sourceMappingURL=LendingDecisionsPanel-Ci_It71q.js.map
